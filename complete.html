<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Cricket Team Manager - Complete PWA</title>
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#3b82f6">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Cricket PWA">
    
    <!-- Essential functions to prevent "not defined" errors -->
    <script>
        // Ensure functions are available immediately and can't be overridden easily
        (function() {
            console.log('üöÄ Loading critical functions...');
            
            // Define critical functions immediately with error handling
            window.showPage = function(pageId) {
                try {
                    console.log('üöÄ showPage called:', pageId);
                    
                    // Hide all content pages
                    const allPages = document.querySelectorAll('.content');
                    allPages.forEach(page => {
                        page.classList.remove('active');
                    });
                    
                    // Show the requested page
                    const targetPage = document.getElementById(pageId);
                    if (targetPage) {
                        targetPage.classList.add('active');
                        
                        // Show/hide back button based on page
                        const backBtn = document.getElementById('backBtn');
                        if (backBtn) {
                            if (pageId === 'home') {
                                backBtn.style.display = 'none';
                            } else {
                                backBtn.style.display = 'block';
                            }
                        }
                        
                        // Load page-specific content
                        if (pageId === 'players' && window.cricketApp) {
                            console.log('üéØ Loading players page, cricketApp exists:', !!window.cricketApp);
                            console.log('üéØ Players array length:', window.cricketApp.players.length);
                            window.cricketApp.loadPlayers();
                        } else if (pageId === 'teams' && window.cricketApp) {
                            // Load teams if needed
                            console.log('Teams page loaded');
                        } else if (pageId === 'scoring' && window.cricketApp) {
                            // Load scoring interface if needed
                            console.log('Scoring page loaded');
                        }
                        
                        console.log('‚úÖ Page switched to:', pageId);
                        return true;
                    } else {
                        console.error('‚ùå Page not found:', pageId);
                        alert('Page not found: ' + pageId);
                        return false;
                    }
                } catch (error) {
                    console.error('Error in showPage:', error);
                    alert('Navigation error: ' + error.message);
                    return false;
                }
            };
            
            window.navigateToPage = function(pageId, clickedTab) {
                try {
                    console.log('üöÄ navigateToPage called:', pageId);
                    
                    // Remove active class from all nav items
                    const allNavItems = document.querySelectorAll('.bottom-nav .nav-item');
                    allNavItems.forEach(item => {
                        item.classList.remove('active');
                    });
                    
                    // Add active class to clicked tab
                    if (clickedTab) {
                        clickedTab.classList.add('active');
                    }
                    
                    // Navigate to the page using existing showPage function
                    showPage(pageId);
                    
                    return true;
                } catch (error) {
                    console.error('Error in navigateToPage:', error);
                    return false;
                }
            };
            
            window.goBack = function() {
                try {
                    console.log('üîô Going back to home');
                    showPage('home');
                    
                    // Hide the back button when on home
                    const backBtn = document.getElementById('backBtn');
                    if (backBtn) {
                        backBtn.style.display = 'none';
                    }
                    
                    return true;
                } catch (error) {
                    console.error('Error in goBack:', error);
                    return false;
                }
            };
            
            window.handleRunButton = function(runs) {
                try {
                    console.log('üèè handleRunButton called:', runs);
                    alert('Run: ' + runs + ' runs (app loading...)');
                    return true;
                } catch (error) {
                    console.error('Error in handleRunButton:', error);
                    alert('Run button error: ' + error.message);
                    return false;
                }
            };
            
            window.goBack = function() {
                try {
                    console.log('‚¨ÖÔ∏è goBack called');
                    alert('Go back (app loading...)');
                    return true;
                } catch (error) {
                    console.error('Error in goBack:', error);
                    alert('Go back error: ' + error.message);
                    return false;
                }
            };
            
            window.removePlayer = function(id) {
                try {
                    console.log('üóëÔ∏è removePlayer called:', id);
                    alert('Remove player: ' + id + ' (app loading...)');
                    return true;
                } catch (error) {
                    console.error('Error in removePlayer:', error);
                    alert('Remove player error: ' + error.message);
                    return false;
                }
            };
            
            window.editPlayer = function(id) {
                try {
                    console.log('‚úèÔ∏è editPlayer called, redirecting to openEditPlayerModal:', id);
                    // Redirect to the new modal function
                    if (typeof openEditPlayerModal === 'function') {
                        openEditPlayerModal(id);
                    } else {
                        console.log('openEditPlayerModal not available yet, showing placeholder');
                        alert('Edit player: ' + id + ' (app loading...)');
                    }
                    return true;
                } catch (error) {
                    console.error('Error in editPlayer:', error);
                    alert('Edit player error: ' + error.message);
                    return false;
                }
            };
            
            window.generateBalancedTeams = function() {
                try {
                    console.log('‚öñÔ∏è generateBalancedTeams called');
                    alert('Generate teams (app loading...)');
                    return true;
                } catch (error) {
                    console.error('Error in generateBalancedTeams:', error);
                    alert('Generate teams error: ' + error.message);
                    return false;
                }
            };
            
            // Debug function to check if functions are available
            window.checkFunctions = function() {
                const functions = ['showPage', 'handleRunButton', 'goBack', 'removePlayer', 'editPlayer', 'generateBalancedTeams'];
                functions.forEach(func => {
                    console.log(func + ':', typeof window[func]);
                });
            };
            
            // Test function
            window.testClick = function() {
                alert('‚úÖ Test click works!');
                console.log('‚úÖ Test click executed');
                return true;
            };
            
            console.log('‚úÖ Critical functions loaded successfully');
            console.log('Functions available:', typeof window.showPage, typeof window.handleRunButton);
            
            // Verify they're actually callable
            if (typeof window.showPage === 'function') {
                console.log('‚úÖ showPage function verified');
            } else {
                console.error('‚ùå showPage function not available');
            }
            
        })();
    </script>
    
    <style>
        /* Modern CSS Variables */
        :root {
            --primary-50: #eff6ff;
            --primary-500: #3b82f6;
            --primary-600: #2563eb;
            --primary-700: #1d4ed8;
            --success-500: #22c55e;
            --success-600: #16a34a;
            --error-500: #ef4444;
            --warning-500: #f59e0b;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }

        .app-container {
            max-width: 414px;
            margin: 0 auto;
            min-height: 100vh;
            background: rgba(0, 0, 0, 0.1);
            position: relative;
            padding-bottom: 80px;
        }

        /* Navigation Styles */
        .top-nav {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-title {
            font-size: 1.2em;
            font-weight: bold;
        }

        .back-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.1em;
            cursor: pointer;
            padding: 5px;
        }

        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 414px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            padding: 8px 0;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--gray-500);
            text-decoration: none;
        }

        .nav-item.active {
            color: var(--primary-600);
        }

        .nav-item:hover {
            transform: translateY(-2px);
        }

        .nav-icon {
            font-size: 1.4em;
            margin-bottom: 4px;
        }

        .nav-label {
            font-size: 0.7em;
            font-weight: 500;
        }

        /* Content Styles */
        .content {
            padding: 20px;
            display: none;
        }

        .content.active {
            display: block;
        }

        .page-header {
            margin-bottom: 30px;
        }

        .page-title {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .page-subtitle {
            opacity: 0.8;
            font-size: 1.1em;
        }

        /* Card Styles */
        .card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
            margin: 15px 0;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 24px;
            margin: 20px 0;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        /* Status Grid */
        .status-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        .status-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .status-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            transform: translate(20px, -20px);
        }

        .status-number {
            font-size: 2.5em;
            font-weight: bold;
            margin: 15px 0 5px 0;
        }

        .status-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        /* Button Styles */
        .btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 12px;
            padding: 16px 24px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin: 8px 0;
            font-size: 1em;
            position: relative;
            overflow: hidden;
        }

        .btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-primary {
            background: var(--primary-600);
        }

        .btn-success {
            background: var(--success-600);
        }

        .btn-info {
            background: #17a2b8;
            color: white;
        }

        .btn-info:hover {
            background: #138496;
        }

        .btn-warning {
            background: var(--warning-500);
        }

        .btn-orange {
            background: #ff8c00;
            color: white;
        }

        .btn-orange:hover {
            background: #ff7700;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* Match History Styles */
        .match-history-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 16px;
            margin: 12px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .match-history-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .match-summary {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .match-teams {
            font-weight: 600;
            font-size: 1.1em;
            color: white;
        }

        .match-date {
            font-size: 0.85em;
            color: rgba(255, 255, 255, 0.7);
        }

        .match-result {
            font-size: 0.95em;
            color: var(--success-400);
            margin: 4px 0;
        }

        .match-mom {
            font-size: 0.9em;
            color: var(--warning-400);
        }

        .match-scores {
            font-size: 0.9em;
            color: rgba(255, 255, 255, 0.8);
            margin: 4px 0;
        }

        .no-matches {
            text-align: center;
            color: rgba(255, 255, 255, 0.6);
            font-style: italic;
            padding: 20px;
        }

        /* Match Scorecard Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: rgba(26, 35, 126, 0.95);
            border-radius: 20px;
            padding: 24px;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            position: relative;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            padding-bottom: 16px;
        }

        .modal-title {
            font-size: 1.3em;
            font-weight: 600;
            color: white;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5em;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .scorecard-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
        }

        .scorecard-header {
            font-weight: 600;
            font-size: 1.1em;
            color: var(--primary-400);
            margin-bottom: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            padding-bottom: 8px;
        }

        .match-actions {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        .btn-danger {
            background: var(--danger-600);
        }

        .btn-danger:hover {
            background: var(--danger-700);
        }

        /* Form Styles */
        .form-group {
            margin: 20px 0;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 0.9em;
        }

        .form-input {
            width: 100%;
            padding: 16px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-500);
            background: rgba(255, 255, 255, 0.15);
        }

        .form-select {
            width: 100%;
            padding: 16px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1em;
            cursor: pointer;
        }

        /* List Styles */
        .player-list, .team-list {
            margin: 20px 0;
        }

        .player-item, .team-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 16px;
            margin: 8px 0;
            display: flex;
            justify-content: between;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .player-info {
            flex: 1;
        }

        .player-name {
            font-weight: 600;
            font-size: 1.1em;
            margin-bottom: 4px;
        }

        .player-stats {
            font-size: 0.9em;
            opacity: 0.8;
        }

        /* Simplified Team Display */
        .simple-team-box {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
            margin: 16px 0;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .simple-team-box h3 {
            margin: 0 0 16px 0;
            font-size: 1.3em;
            color: #ff6b35;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            padding-bottom: 8px;
        }

        .simple-team-box .simple-players {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .simple-team-box .simple-player {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 500;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Toss Button */
        .toss-btn {
            background: linear-gradient(135deg, #ff6b35, #ff8c42);
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 12px;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            margin: 20px auto;
            display: block;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .toss-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 53, 0.4);
        }

        .toss-btn:active {
            transform: translateY(0);
        }

        /* Player Selection Styles */
        .player-btn, .bowler-btn {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            text-align: center;
        }

        .player-btn:hover, .bowler-btn:hover {
            background: rgba(255,255,255,0.2);
            border-color: rgba(255,255,255,0.5);
            transform: translateY(-2px);
        }

        .player-btn.selected {
            background: #22c55e !important;
            border-color: #22c55e !important;
            transform: scale(1.05);
        }

        .bowler-btn.selected {
            background: #1d4ed8 !important;
            border-color: #1d4ed8 !important;
            transform: scale(1.05);
        }

        .selection-summary {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }

        .selection-summary h4 {
            color: #22c55e;
            margin-bottom: 10px;
        }

        .selected-players {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .selected-player {
            background: rgba(34, 197, 94, 0.2);
            border: 1px solid #22c55e;
            color: #22c55e;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.9em;
        }

        .player-actions {
            display: flex;
            gap: 8px;
        }

        .btn-small {
            padding: 8px 12px;
            font-size: 0.8em;
            min-width: 60px;
        }

        /* Scoring Styles */
        .score-board {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 16px;
            margin: 15px 0;
            text-align: center;
        }

        .score-main {
            margin-bottom: 8px;
        }

        .score-display {
            font-size: 2.5em;
            font-weight: bold;
            margin: 8px 0;
            color: #ff6b35;
        }

        .target-info {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            padding: 12px;
            font-size: 0.9em;
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }

        .batting-info, .bowling-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
            padding: 8px 0;
        }

        .batting-info {
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .batsman {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }

        .batsman-name, .bowler-name {
            font-weight: 600;
            font-size: 1.1em;
        }

        .batsman-score, .bowler-figures {
            font-size: 0.9em;
            opacity: 0.8;
            margin-top: 4px;
        }

        .score-actions {
            margin: 20px 0;
        }

        .score-section {
            margin: 20px 0;
        }

        .score-section h4 {
            color: #ff6b35;
            margin-bottom: 12px;
            text-align: center;
            font-size: 1.2em;
        }

        .score-buttons-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .score-btn {
            aspect-ratio: 1;
            border-radius: 12px;
            font-size: 1.2em;
            font-weight: bold;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            transition: all 0.3s ease;
        }

        .score-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.2);
        }

        .score-btn.boundary {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            border-color: #22c55e;
        }

        .score-btn.extra {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            border-color: #f59e0b;
        }

        .score-btn.wicket {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            border-color: #ef4444;
        }

        .over-summary {
            display: flex;
            justify-content: flex-start;
            gap: 8px;
            margin: 15px 0;
            overflow-x: auto;
            overflow-y: hidden;
            padding: 5px 0;
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.3) transparent;
        }

        .over-summary::-webkit-scrollbar {
            height: 6px;
        }

        .over-summary::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }

        .over-summary::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
        }

        .over-summary::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        .ball {
            width: 35px;
            height: 35px;
            min-width: 35px;
            flex-shrink: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .ball.four {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
        }

        .ball.six {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }

        .ball.wicket {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }

        .ball.dot {
            background: rgba(100, 100, 100, 0.5);
        }

        .ball.extra {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .toggle-extra.active {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8) !important;
            color: white !important;
            border: 2px solid #1d4ed8 !important;
        }

        .extra-instructions {
            text-align: center;
            font-size: 0.9em;
            color: #ff6b35;
            margin-top: 10px;
            padding: 8px;
            background: rgba(255, 107, 53, 0.1);
            border-radius: 5px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.8; }
            50% { opacity: 1; }
            100% { opacity: 0.8; }
        }

        .over-total {
            text-align: center;
            font-size: 0.9em;
            opacity: 0.8;
            margin-top: 10px;
        }

        .match-actions {
            display: flex;
            gap: 12px;
            justify-content: space-between;
        }

        .match-actions .btn {
            flex: 1;
            margin: 0;
        }

        /* Animation Classes */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        .slide-up {
            animation: slideUp 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* Inline Team Generation Styles */
        .step-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .step-header h3 {
            margin: 0;
            color: #FFD700;
            font-size: 1.3em;
        }
        
        .player-count, .selected-info, .strength-diff {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            padding: 8px 12px;
            border-radius: 15px;
            font-size: 1.5em;
            font-weight: 700;
            min-width: 50px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .selection-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .btn-small {
            padding: 5px 12px;
            font-size: 0.8em;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-small:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }
        
        .today-player-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 20px;
        }
        
        .captain-selection-inline {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .teams-result-inline {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            align-items: stretch;
            margin-bottom: 20px;
        }
        
        .team-result-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            min-height: 200px;
            height: 100%;
        }
        
        .team-result-card h4 {
            margin: 0 0 10px 0;
            color: #FFD700;
            font-size: 1.1em;
        }
        
        .team-result-card p {
            margin: 5px 0;
            font-size: 0.9em;
        }
        
        .team-players {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            margin-top: 15px;
            flex: 1;
            align-content: flex-start;
        }
        
        .player-tag {
            background: rgba(100, 200, 255, 0.2);
            color: #87CEEB;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            border: 1px solid rgba(135, 206, 235, 0.3);
        }
        
        .vs-divider {
            font-size: 1.5em;
            font-weight: bold;
            color: #FFD700;
            text-align: center;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
        }
        
        .step-actions {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .step-actions .btn {
            width: auto;
            flex: none;
            padding: 12px 16px;
            font-size: 0.9em;
            min-width: 0;
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @media (max-width: 768px) {
            .teams-result-inline {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .vs-divider {
                order: 2;
            }
            
            .step-actions {
                flex-direction: column;
            }
            
            .step-header {
                flex-direction: column;
                gap: 10px;
                align-items: stretch;
            }
        }
        
        /* Modal Styles (legacy support) */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal.active {
            display: flex;
        }

        /* Modal Overlay Styles for Wicket Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin: 20px;
            max-width: 350px;
            width: 100%;
            backdrop-filter: blur(20px);
            color: var(--gray-800);
        }

        /* Manual Adjustment Modal Styles */
        .manual-adjust-container {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 20px;
            margin: 20px 0;
            min-height: 400px;
        }

        .team-column {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .team-column h4 {
            color: white;
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .player-list-adjust {
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-height: 350px;
            overflow-y: auto;
        }

        .player-item-adjust {
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            font-weight: 500;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .player-item-adjust:hover:not(.captain) {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.3);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
            transform: translateY(-2px);
        }

        .player-item-adjust.selected {
            background: rgba(59, 130, 246, 0.3);
            border-color: #3B82F6;
            color: #FFD700;
        }

        .player-item-adjust.captain {
            border-left: 4px solid #FFD700;
            font-weight: 600;
            cursor: not-allowed;
            opacity: 0.7;
            box-shadow: none;
        }

        .player-item-adjust.captain:hover {
            transform: none;
            box-shadow: none;
        }

        .swap-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 15px;
            padding: 20px 10px;
        }

        .swap-controls .btn {
            font-size: 1.2em;
            padding: 12px 20px;
            white-space: nowrap;
        }

        .swap-info {
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9em;
            line-height: 1.4;
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        /* Player Selection - Clickable Cards */
        .player-checkbox-item {
            display: block;
            width: 100%;
            padding: 16px 20px;
            margin: 0 0 12px 0;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            min-height: 60px;
            display: flex;
            align-items: center;
        }

        .player-checkbox-item:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 215, 0, 0.5);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .player-checkbox-item.selected {
            background: rgba(255, 215, 0, 0.2);
            border-color: #FFD700;
            box-shadow: 0 0 0 2px rgba(255, 215, 0, 0.3);
        }

        .player-checkbox-item.selected:hover {
            background: rgba(255, 215, 0, 0.25);
        }

        .player-checkbox-item input[type="checkbox"] {
            display: none;
        }

        .player-checkbox-info {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .player-checkbox-info .player-name {
            font-size: 1.1em;
            font-weight: 600;
            color: white;
        }

        .player-checkbox-item.selected .player-name {
            color: #FFD700;
        }

        .player-star {
            font-size: 1.2em;
            margin-left: 10px;
        }

        .selection-indicator {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.4);
            border-radius: 50%;
            background: transparent;
            transition: all 0.3s ease;
        }

        .player-checkbox-item.selected .selection-indicator {
            background: #FFD700;
            border-color: #FFD700;
        }

        .player-checkbox-item.selected .selection-indicator::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #000;
            font-size: 12px;
            font-weight: bold;
        }

        .selection-controls {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }

        .player-count {
            color: var(--primary-500);
            font-weight: bold;
        }

        .captain-selection {
            margin: 20px 0;
        }

        .form-group {
            margin: 15px 0;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--gray-300);
            border-radius: 8px;
            font-size: 16px;
            background: white;
        }

        /* Teams Result Modal Styles */
        .teams-result {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .team-result {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }

        .team-result h4 {
            margin: 0 0 10px 0;
            color: var(--primary-600);
        }

        .team-result p {
            margin: 5px 0;
        }

        .team-players {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            margin-top: 15px;
        }

        .player-tag {
            background: var(--primary-500);
            color: white;
            padding: 10px 14px;
            border-radius: 20px;
            font-size: 1em;
            font-weight: 500;
            display: inline-block;
            margin: 4px;
            transition: all 0.3s ease;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .player-tag.clickable {
            cursor: pointer;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
        }

        .player-tag.clickable:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
            background: var(--primary-600);
        }

        .player-tag.captain {
            background: #FFD700;
            color: #1f2937;
            font-weight: 700;
            cursor: not-allowed;
            opacity: 0.9;
        }

        .vs-divider {
            text-align: center;
            font-size: 1.5em;
            font-weight: bold;
            color: var(--primary-500);
            margin: 10px 0;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-footer {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        /* Edit Player Modal Styles */
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .modal-header h3 {
            margin: 0;
            color: var(--gray-800);
            font-size: 1.5rem;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray-600);
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            color: var(--gray-800);
        }

        .modal-body {
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: var(--gray-700);
        }

        .form-input, .form-select {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--gray-300);
            border-radius: 8px;
            font-size: 16px;
            background: white;
            color: var(--gray-800);
            box-sizing: border-box;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
        }

        /* Player Name Only Styles */
        .player-name-only {
            font-size: 1.1rem;
            font-weight: 600;
            color: white;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .player-item:hover .player-name-only {
            color: var(--primary-300);
            transform: scale(1.05);
        }

        .player-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        /* Settings and Data Management Styles */
        .stats-section {
            margin: 15px 0;
        }

        .performer-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .performer-rank {
            font-size: 18px;
            font-weight: bold;
            color: var(--primary-500);
            margin-right: 15px;
            min-width: 30px;
        }

        .performer-details {
            flex: 1;
        }

        .performer-name {
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 4px;
        }

        .performer-stats {
            font-size: 14px;
            opacity: 0.8;
        }

        .advanced-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .stat-card h4 {
            margin: 0 0 10px 0;
            font-size: 14px;
            opacity: 0.8;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-500);
        }

        .data-management {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
        }

        .data-management button {
            width: 100%;
            max-width: 200px;
        }

        .modal-header {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }

        /* Responsive adjustments */
        @media (max-width: 480px) {
            .app-container {
                max-width: 100%;
            }
            
            .bottom-nav {
                max-width: 100%;
            }
        }

        /* Loading states */
        .loading {
            opacity: 0.5;
            pointer-events: none;
        }

        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Enhanced Analytics Styles */
        .analytics-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .analytics-controls label {
            font-weight: bold;
            color: rgba(255, 255, 255, 0.9);
        }

        .analytics-controls select {
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 14px;
            backdrop-filter: blur(10px);
        }

        .analytics-btn {
            background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .analytics-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
        }

        .analytics-grid {
            display: grid;
            gap: 15px;
            grid-template-columns: 1fr;
        }

        .player-analytics-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            cursor: pointer;
            transition: all 0.3s ease;
            display: grid;
            grid-template-columns: auto 1fr auto;
            gap: 15px;
            align-items: center;
        }

        .player-analytics-card:hover {
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .player-rank {
            background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
        }

        .player-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .player-name {
            font-weight: bold;
            font-size: 16px;
            color: white;
        }

        .player-role {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            text-transform: capitalize;
        }

        .player-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            font-size: 12px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            color: rgba(255, 255, 255, 0.8);
        }

        .stat-label {
            font-weight: 500;
        }

        .stat-value {
            font-weight: bold;
            color: white;
        }

        .performance-score {
            text-align: center;
            background: linear-gradient(135deg, var(--success-500), var(--success-600));
            padding: 8px;
            border-radius: 8px;
        }

        .score-label {
            font-size: 10px;
            opacity: 0.9;
            margin-bottom: 2px;
        }

        .score-value {
            font-size: 16px;
            font-weight: bold;
        }

        .trends-container {
            display: grid;
            gap: 15px;
            grid-template-columns: 1fr;
        }

        .trend-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }

        .trend-card h4 {
            margin-bottom: 12px;
            color: white;
            font-size: 16px;
        }

        .trend-metrics {
            display: grid;
            gap: 8px;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
        }

        .trend-value {
            font-weight: bold;
            color: white;
        }

        .trend-value.positive {
            color: var(--success-500);
        }

        .trend-value.negative {
            color: var(--error-500);
        }

        .top-performers-recent {
            display: grid;
            gap: 8px;
        }

        .performer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
        }

        .frequency-stats {
            display: grid;
            gap: 8px;
        }

        .chart-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .chart-btn {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .chart-btn.active,
        .chart-btn:hover {
            background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
            color: white;
            border-color: var(--primary-500);
            transform: translateY(-1px);
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .chart-container h4 {
            margin-bottom: 20px;
            color: white;
            text-align: center;
        }

        .performance-bars {
            display: grid;
            gap: 12px;
        }

        .performance-bar-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .bar-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            flex-wrap: wrap;
            gap: 5px;
        }

        .bar-info .player-name {
            font-weight: bold;
            color: white;
        }

        .bar-info .player-stats {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        .bar-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            height: 24px;
            position: relative;
            overflow: hidden;
        }

        .performance-bar {
            height: 100%;
            border-radius: 6px;
            position: relative;
            transition: width 0.8s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 8px;
        }

        .bar-value {
            color: white;
            font-weight: bold;
            font-size: 12px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        .comparison-controls {
            margin-bottom: 20px;
        }

        .player-selectors {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .player-selectors select {
            flex: 1;
            min-width: 150px;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            backdrop-filter: blur(10px);
        }

        .spider-placeholder {
            text-align: center;
            padding: 40px 20px;
            color: rgba(255, 255, 255, 0.7);
            font-style: italic;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            border: 2px dashed rgba(255, 255, 255, 0.2);
        }

        .spider-chart {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .spider-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: white;
            font-size: 14px;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
        }

        .player1-color {
            background: var(--primary-500);
        }

        .player2-color {
            background: var(--success-500);
        }

        .spider-web {
            position: relative;
            height: 300px;
            border-radius: 50%;
            margin: 20px auto;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 1px, transparent 1px);
            background-size: 50px 50px;
        }

        .spider-axis {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 150px;
            height: 2px;
            transform-origin: 0 50%;
        }

        .axis-line {
            width: 100%;
            height: 1px;
            background: rgba(255, 255, 255, 0.3);
        }

        .axis-label {
            position: absolute;
            right: -60px;
            top: -10px;
            color: white;
            font-size: 12px;
            font-weight: bold;
            text-align: center;
            width: 80px;
        }

        .player1-point,
        .player2-point {
            position: absolute;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            transform: translateX(-4px) translateY(-4px);
        }

        .player1-point {
            background: var(--primary-500);
            box-shadow: 0 0 10px var(--primary-500);
        }

        .player2-point {
            background: var(--success-500);
            box-shadow: 0 0 10px var(--success-500);
        }

        .comparison-stats {
            margin-top: 20px;
        }

        .player-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .player-stats-detailed {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
        }

        .player-stats-detailed h5 {
            margin-bottom: 10px;
            color: white;
            text-align: center;
            font-size: 16px;
        }

        .metric-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 13px;
            color: rgba(255, 255, 255, 0.8);
        }

        .metric-row span:last-child {
            font-weight: bold;
            color: white;
        }

        /* Modal Styles for Analytics */
        .analytics-modal {
            max-width: 90vw;
            max-height: 90vh;
            width: 600px;
        }

        .comparison-interface {
            display: grid;
            gap: 20px;
        }

        .player-selection {
            display: grid;
            gap: 15px;
        }

        .selector-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .selector-group label {
            font-weight: bold;
            color: white;
        }

        .selector-group select {
            padding: 10px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            backdrop-filter: blur(10px);
        }

        .detailed-comparison {
            margin-top: 20px;
        }

        .detailed-comparison h4 {
            margin-bottom: 20px;
            color: white;
            text-align: center;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .comparison-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .comparison-card h5 {
            margin-bottom: 15px;
            color: white;
            text-align: center;
        }

        .player-metrics {
            display: grid;
            gap: 10px;
        }

        .metric-item {
            display: grid;
            gap: 5px;
        }

        .metric-name {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 500;
        }

        .metric-bar {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            height: 20px;
            position: relative;
            overflow: hidden;
        }

        .metric-fill {
            height: 100%;
            border-radius: 6px;
            transition: width 0.8s ease;
        }

        .metric-value {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-size: 10px;
            font-weight: bold;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        .comparison-summary {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .comparison-summary h5 {
            margin-bottom: 10px;
            color: white;
        }

        .analysis-points {
            display: grid;
            gap: 5px;
        }

        .insight-item {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            padding: 5px 0;
        }

        /* Player Details Modal */
        .player-details-modal {
            max-width: 95vw;
            max-height: 95vh;
            width: 700px;
        }

        .player-profile {
            display: grid;
            gap: 20px;
        }

        .profile-info {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
            text-align: center;
        }

        .info-item .label {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 500;
        }

        .info-item .value {
            font-size: 16px;
            color: white;
            font-weight: bold;
        }

        .stats-sections {
            display: grid;
            gap: 20px;
        }

        .stats-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stats-section h4 {
            margin-bottom: 15px;
            color: white;
            font-size: 18px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 12px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-card .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: white;
            margin-bottom: 4px;
        }

        .stat-card .stat-label {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 500;
        }

        /* Responsive adjustments for analytics */
        @media (max-width: 768px) {
            .analytics-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .chart-controls {
                flex-direction: column;
            }

            .player-selectors {
                flex-direction: column;
            }

            .comparison-grid {
                grid-template-columns: 1fr;
            }

            .player-comparison {
                grid-template-columns: 1fr;
            }

            .spider-web {
                height: 250px;
            }

            .axis-label {
                font-size: 11px;
                width: 70px;
                right: -50px;
            }

            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            }

            .profile-info {
                grid-template-columns: 1fr;
            }
        }

        /* Enhanced Analytics Dashboard Styles */
        .analytics-dashboard {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .analytics-sections {
            display: grid;
            gap: 20px;
        }

        .analytics-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .section-header h4 {
            margin: 0;
            color: white;
            font-size: 18px;
            font-weight: 600;
        }

        /* Consistent Button Styling */
        .analytics-btn,
        .chart-btn {
            font-family: inherit;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 8px 16px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            text-decoration: none;
            white-space: nowrap;
        }

        .analytics-btn {
            background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
            color: white;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.2);
        }

        .analytics-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .chart-btn {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .chart-btn:hover,
        .chart-btn.active {
            background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
            color: white;
            border-color: var(--primary-500);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.2);
        }

        /* Consistent Select Styling */
        .analytics-controls select,
        .player-selectors select,
        .selector-group select {
            font-family: inherit;
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 14px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .analytics-controls select:focus,
        .player-selectors select:focus,
        .selector-group select:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
        }

        /* Consistent Card Styling */
        .player-analytics-card,
        .trend-card,
        .chart-container,
        .comparison-card,
        .stat-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .player-analytics-card:hover,
        .comparison-card:hover {
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 0.12);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        /* Consistent Typography */
        .analytics-section h4,
        .chart-container h4,
        .trend-card h4 {
            color: white;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .player-name,
        .metric-name,
        .info-item .value {
            color: white;
            font-weight: 600;
        }

        .player-role,
        .metric-value,
        .info-item .label {
            color: rgba(255, 255, 255, 0.8);
        }

        /* Consistent Spacing */
        .analytics-grid,
        .trends-container,
        .performance-bars,
        .stats-grid {
            display: grid;
            gap: 15px;
        }

        /* Loading and Empty States */
        .analytics-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
            color: rgba(255, 255, 255, 0.7);
            font-style: italic;
        }

        .analytics-empty {
            text-align: center;
            padding: 40px 20px;
            color: rgba(255, 255, 255, 0.7);
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            border: 2px dashed rgba(255, 255, 255, 0.1);
        }

        .analytics-empty h5 {
            margin-bottom: 10px;
            color: rgba(255, 255, 255, 0.9);
        }

        /* Advanced Analytics Specific Styles */
        .performance-rating {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .rating-bar {
            flex: 1;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .rating-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.8s ease;
        }

        .rating-fill.excellent {
            background: linear-gradient(90deg, var(--success-500), var(--success-600));
        }

        .rating-fill.good {
            background: linear-gradient(90deg, var(--primary-500), var(--primary-600));
        }

        .rating-fill.average {
            background: linear-gradient(90deg, var(--warning-500), #f59e0b);
        }

        .rating-fill.poor {
            background: linear-gradient(90deg, var(--error-500), #dc2626);
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .insight-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .insight-card h5 {
            color: white;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .insight-list {
            display: grid;
            gap: 8px;
        }

        .insight-item {
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            border-left: 3px solid var(--primary-500);
            font-size: 14px;
            color: rgba(255, 255, 255, 0.9);
        }

        .recommendation-item {
            padding: 10px 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            border-left: 4px solid;
        }

        .recommendation-item.high {
            background: rgba(239, 68, 68, 0.1);
            border-left-color: var(--error-500);
        }

        .recommendation-item.medium {
            background: rgba(245, 158, 11, 0.1);
            border-left-color: var(--warning-500);
        }

        .recommendation-item.low {
            background: rgba(34, 197, 94, 0.1);
            border-left-color: var(--success-500);
        }

    </style>
</head>
<body>
    <div class="app-container" id="app">
        <!-- Top Navigation -->
        <div class="top-nav">
            <button class="back-btn" id="backBtn" style="display: none;" onclick="goBack();">‚Üê Back</button>
            <div class="nav-title" id="navTitle">Cricket Manager</div>
            <div></div>
        </div>

        <!-- HOME PAGE -->
        <div class="content active" id="home">
            <div class="page-header fade-in">
                <div class="page-title" id="greeting">Good Evening! üåô</div>
                <div class="page-subtitle" id="date">Ready to play cricket?</div>
            </div>

            <div class="glass-card slide-up">
                <h3>üìä Overview</h3>
                <div class="status-grid">
                    <div class="status-card">
                        <div class="status-number" id="playerCount">0</div>
                        <div class="status-label">Players</div>
                    </div>
                    <div class="status-card">
                        <div class="status-number" id="teamCount">0</div>
                        <div class="status-label">Teams</div>
                    </div>
                    <div class="status-card">
                        <div class="status-number" id="matchCount">0</div>
                        <div class="status-label">Matches</div>
                    </div>
                    <div class="status-card">
                        <div class="status-number" id="matchFormat">20</div>
                        <div class="status-label">Overs</div>
                    </div>
                </div>
            </div>

            <div class="glass-card slide-up">
                <h3>‚ö° Quick Actions</h3>
                <button class="btn btn-primary" onclick="console.log('Players clicked'); showPage('players');">
                    üë• Manage Players
                </button>
                <button class="btn btn-success" onclick="console.log('Teams clicked'); showPage('teams');" id="teamsBtn">
                    ‚ö° Create Teams
                </button>
                <button class="btn" onclick="console.log('Settings clicked'); showPage('settings');">
                    ‚öôÔ∏è View Settings
                </button>
            </div>

            <div class="glass-card slide-up">
                <h3>üìä Match History</h3>
                <div id="matchHistoryContainer">
                    <!-- Match history will be loaded here -->
                </div>
            </div>
        </div>

        <!-- PLAYERS PAGE -->
        <div class="content" id="players">
            <div class="page-header">
                <div class="page-title">üë• Players</div>
                <div class="page-subtitle">Manage your team roster</div>
            </div>

            <div class="glass-card">
                <button class="btn btn-primary" onclick="window.cricketApp.showAddPlayerModal()">
                    ‚ûï Add New Player
                </button>
                <button class="btn btn-success" onclick="exportAllPlayersToJSON()" style="margin-left: 10px;">
                    üì• Export Players JSON
                </button>
                <button class="btn btn-info" onclick="window.cricketApp.importAndMergeData()" style="margin-left: 10px;">
                    üì§ Import & Merge Data
                </button>
            </div>

            <div class="player-list" id="playerList">
                <!-- Players will be dynamically loaded here -->
            </div>
        </div>

        <!-- TEAMS PAGE -->
        <div class="content" id="teams">
            <div class="page-header">
                <div class="page-title">‚ö° Teams</div>
                <div class="page-subtitle">Create balanced teams</div>
            </div>

            <div class="glass-card">
                <button class="btn btn-success" onclick="console.log('Button clicked!', window.cricketApp); window.cricketApp && window.cricketApp.generateBalancedTeams()" id="generateTeamsBtn">
                    üéØ Generate Balanced Teams
                </button>
            </div>

            <div class="team-list" id="teamList">
                <!-- Teams will be dynamically loaded here -->
            </div>
        </div>

        <!-- SCORING PAGE -->
        <div class="content" id="scoring">
            <div class="page-header">
                <div class="page-title">üèè Live Scoring</div>
            </div>

            <!-- Score Display -->
            <div class="score-board">
                <div class="score-main">
                    <div id="currentTeam" style="font-size: 1.1em; margin-bottom: 5px;">Team A</div>
                    <div style="display: flex; justify-content: space-between; align-items: center; gap: 15px;">
                        <div class="score-display" id="currentScore">0/0</div>
                        <div id="currentOver" style="font-size: 1em; opacity: 0.9;">Over: 0.0</div>
                    </div>
                </div>
                <div class="target-info" id="targetInfo" style="display: none;">
                    <div>Target: <span id="targetRuns">150</span></div>
                    <div>Need: <span id="requiredRuns">150</span> off <span id="ballsLeft">120</span> balls</div>
                    <div>RRR: <span id="requiredRunRate">7.50</span></div>
                </div>
            </div>

            <!-- Main Scoring Buttons -->
            <div class="score-actions">
                <div class="score-section">
                    <div class="score-buttons-grid">
                        <button class="btn score-btn" onclick="console.log('Run 0 clicked'); alert('Run: 0');">0</button>
                        <button class="btn score-btn" onclick="console.log('Run 1 clicked'); alert('Run: 1');">1</button>
                        <button class="btn score-btn" onclick="console.log('Run 2 clicked'); alert('Run: 2');">2</button>
                        <button class="btn score-btn" onclick="console.log('Run 3 clicked'); alert('Run: 3');">3</button>
                        <button class="btn score-btn boundary" onclick="console.log('Run 4 clicked'); alert('Boundary: 4');">4</button>
                        <button class="btn score-btn boundary" onclick="console.log('Run 6 clicked'); alert('Boundary: 6');">6</button>
                    </div>
                </div>

                <div class="score-section">
                    <h4></h4>
                    <div class="score-buttons-grid">
                        <button class="btn score-btn extra toggle-extra" id="wideBtn" onclick="toggleExtra('wide')">Wide</button>
                        <button class="btn score-btn extra toggle-extra" id="noballBtn" onclick="toggleExtra('noball')">No Ball</button>
                        <button class="btn score-btn extra toggle-extra" id="byeBtn" onclick="toggleExtra('bye')">Bye</button>
                    </div>
                    <div id="extraInstructions" class="extra-instructions" style="display: none;">
                        <p></p>
                    </div>
                </div>

                <div class="score-section">
                    <h4></h4>
                    <div class="score-buttons-grid">
                        <button class="btn score-btn wicket" onclick="console.log('Wicket modal clicked'); alert('Wicket modal feature will be implemented soon');">üéØ WICKET</button>
                        <button class="btn score-btn" onclick="console.log('Undo last ball clicked'); alert('Undo feature will be implemented soon');">‚Ü∂ Undo</button>
                        <button class="btn score-btn" onclick="console.log('Swap batsmen clicked'); alert('Swap strike feature will be implemented soon');">Swap Strike</button>
                    </div>
                </div>
            </div>

            <!-- Current Players -->
            <div class="glass-card">
                <div class="batting-info">
                    <div class="batsman">
                        <span class="batsman-name" id="strikerName">Striker</span>
                        <span class="batsman-score" id="strikerScore">0* (0)</span>
                    </div>
                    <div class="batsman">
                        <span class="batsman-name" id="nonStrikerName">Non-Striker</span>
                        <span class="batsman-score" id="nonStrikerScore">0* (0)</span>
                    </div>
                </div>
                <div class="bowling-info">
                    <span class="bowler-name" id="bowlerName">Bowler</span>
                    <span class="bowler-figures" id="bowlerFigures">0-0-0-0</span>
                </div>
            </div>

            <!-- Quick Over Summary -->
            <div class="glass-card">
                <h4>This Over</h4>
                <div class="over-summary" id="overSummary">
                    <span class="ball">1</span>
                    <span class="ball">2</span>
                    <span class="ball">‚Ä¢</span>
                    <span class="ball">4</span>
                    <span class="ball">1</span>
                    <span class="ball">W</span>
                </div>
                <div class="over-total">Over Total: <span id="overTotal">8 runs, 1 wicket</span></div>
            </div>

            <!-- Match Actions -->
            <div class="glass-card">
                <div class="match-actions">
                    <button class="btn btn-success" onclick="console.log('Show scorecard clicked'); alert('Scorecard feature will be implemented soon');">
                        üìä Scorecard
                    </button>
                    <button class="btn btn-warning" onclick="console.log('End innings clicked'); alert('End innings feature will be implemented soon');">
                        üîÑ End Innings
                    </button>
                    <button class="btn btn-danger" onclick="console.log('End match clicked'); alert('End match feature will be implemented soon');">
                        üèÅ End Match
                    </button>
                </div>
            </div>
        </div>

        <!-- SETTINGS PAGE -->
        <div class="content" id="settings">
            <div class="page-header">
                <div class="page-title">‚öôÔ∏è Settings</div>
                <div class="page-subtitle">App configuration</div>
            </div>


            <div class="glass-card">
                <h3>ÔøΩ Analytics Dashboard</h3>
                <div class="analytics-dashboard" id="analyticsDashboardContent" style="display: none;">
                    <!-- Analytics content will be loaded here -->
                    <div class="analytics-sections">
                        <div class="analytics-section" id="playerAnalyticsSection">
                            <div class="section-header">
                                <h4>üéØ Player Analytics</h4>
                                <div class="analytics-controls">
                                    <select id="sortStat" onchange="window.cricketApp.updatePlayerAnalytics(this.value)">
                                        <option value="runs">Total Runs</option>
                                        <option value="average">Batting Average</option>
                                        <option value="strikeRate">Strike Rate</option>
                                        <option value="wickets">Wickets</option>
                                        <option value="economy">Economy Rate</option>
                                        <option value="matches">Matches Played</option>
                                    </select>
                                    <button onclick="window.cricketApp.showAdvancedAnalytics()" class="analytics-btn">
                                        üß† Advanced Analytics
                                    </button>
                                </div>
                            </div>
                            <div id="playerAnalytics"></div>
                        </div>
                        
                        <div class="analytics-section" id="performanceTrendsSection">
                            <div class="section-header">
                                <h4>üìà Performance Trends</h4>
                            </div>
                            <div id="performanceTrends"></div>
                        </div>
                        
                        <div class="analytics-section" id="interactiveChartsSection">
                            <div class="section-header">
                                <h4>üìä Interactive Charts</h4>
                                <div class="chart-controls">
                                    <button onclick="window.cricketApp.showPerformanceChart('batting')" class="chart-btn active" id="battingChartBtn">
                                        üèè Batting
                                    </button>
                                    <button onclick="window.cricketApp.showPerformanceChart('bowling')" class="chart-btn" id="bowlingChartBtn">
                                        ‚ö° Bowling
                                    </button>
                                    <button onclick="window.cricketApp.showPerformanceChart('comparison')" class="chart-btn" id="comparisonChartBtn">
                                        üîÑ Compare
                                    </button>
                                    <button onclick="window.cricketApp.showPerformanceChart('insights')" class="chart-btn" id="insightsChartBtn">
                                        üß† Insights
                                    </button>
                                </div>
                            </div>
                            <div id="interactiveCharts"></div>
                        </div>
                    </div>
                </div>
                <div class="tile-click-hint" onclick="toggleTile('analyticsDashboardContent', this)" style="cursor: pointer; padding: 10px; text-align: center; color: #666;">
                    Click to expand Analytics Dashboard
                </div>
            </div>

            <div class="glass-card">
                <h3>ÔøΩüíæ Data Management</h3>
                <div class="data-management" id="dataManagementContent" style="display: none;">
                    <button class="btn btn-primary" onclick="console.log('Export data clicked'); alert('Export feature will be implemented soon');">
                        üì§ Export CSV (BCCB Format)
                    </button>
                    <input type="file" id="importFile" accept=".csv,.json" style="display: none;" multiple onchange="console.log('Import file changed'); alert('Import feature will be implemented soon');">
                    <button class="btn btn-success" onclick="console.log('Import triggered'); document.getElementById('importFile').click();">
                        üì• Import Data (CSV/JSON)
                    </button>
                    <p style="margin-top: 10px; font-size: 0.9em; opacity: 0.8;">
                        Export your cricket data as CSV files or import data from other devices
                    </p>
                </div>
                <div class="tile-click-hint" onclick="toggleTile('dataManagementContent', this)" style="cursor: pointer; padding: 10px; text-align: center; color: #666;">
                    Click to expand
                </div>
            </div>

            <div class="glass-card">
                <h3>üèè Match Settings</h3>
                <div class="match-settings" id="matchSettingsContent" style="display: none;">
                    <div class="setting-item" style="margin-bottom: 15px;">
                        <label for="totalOvers" style="display: block; margin-bottom: 5px; font-weight: bold;">Match Overs:</label>
                        <select id="totalOvers" style="width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #ccc;" onchange="handleOversChange(this.value)">
                            <option value="5">5 Overs (Quick)</option>
                            <option value="10">10 Overs (Short)</option>
                            <option value="15">15 Overs (Medium)</option>
                            <option value="20" selected>20 Overs (T20)</option>
                            <option value="25">25 Overs</option>
                            <option value="30">30 Overs</option>
                            <option value="40">40 Overs</option>
                            <option value="50">50 Overs (ODI)</option>
                            <option value="custom">Custom...</option>
                        </select>
                        <input type="number" id="customOvers" placeholder="Enter custom overs (1-100)" 
                               style="width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #ccc; margin-top: 5px; display: none;"
                               min="1" max="100" onblur="setCustomOvers(this.value)">
                        <div style="font-size: 12px; color: rgba(255,255,255,0.7); margin-top: 5px;">
                            ‚ö†Ô∏è Changing overs will affect new matches only
                        </div>
                    </div>
                    
                    <div class="setting-item" style="margin-bottom: 15px;">
                        <label for="runsOnWide" style="display: block; margin-bottom: 5px; font-weight: bold;">Runs on Wide:</label>
                        <select id="runsOnWide" style="width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #ccc;" onchange="saveMatchSetting('runsOnWide', this.value)">
                            <option value="1">1 Run</option>
                            <option value="2">2 Runs</option>
                            <option value="3">3 Runs</option>
                        </select>
                    </div>
                    
                    <div class="setting-item" style="margin-bottom: 15px;">
                        <label for="runsOnNoBall" style="display: block; margin-bottom: 5px; font-weight: bold;">Runs on No Ball:</label>
                        <select id="runsOnNoBall" style="width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #ccc;" onchange="saveMatchSetting('runsOnNoBall', this.value)">
                            <option value="1">1 Run</option>
                            <option value="2">2 Runs</option>
                            <option value="3">3 Runs</option>
                        </select>
                    </div>
                    
                    <div class="setting-item" style="margin-bottom: 15px;">
                        <label for="enableByes" style="display: inline-block; margin-right: 10px; font-weight: bold;">Enable Byes:</label>
                        <input type="checkbox" id="enableByes" style="width: 20px; height: 20px;" onchange="saveMatchSetting('enableByes', this.checked)">
                    </div>
                </div>
                <div class="tile-click-hint" onclick="toggleTile('matchSettingsContent', this)" style="cursor: pointer; padding: 10px; text-align: center; color: #666;">
                    Click to expand
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <a class="nav-item active" onclick="navigateToPage('home', this);">
                <div class="nav-icon">üè†</div>
                <div class="nav-label">Home</div>
            </a>
            <a class="nav-item" onclick="navigateToPage('players', this);">
                <div class="nav-icon">üë•</div>
                <div class="nav-label">Players</div>
            </a>
            <a class="nav-item" onclick="navigateToPage('teams', this);">
                <div class="nav-icon">‚ö°</div>
                <div class="nav-label">Teams</div>
            </a>
            <a class="nav-item" onclick="navigateToPage('scoring', this);">
                <div class="nav-icon">üèè</div>
                <div class="nav-label">Scoring</div>
            </a>
            <a class="nav-item" onclick="navigateToPage('settings', this);">
                <div class="nav-icon">‚öôÔ∏è</div>
                <div class="nav-label">Settings</div>
            </a>
        </nav>
    </div>

    <!-- Add Player Modal -->
    <div class="modal" id="addPlayerModal">
        <div class="modal-content">
            <div class="modal-header">Add New Player</div>
            <form onsubmit="addPlayer(event)">
                <div class="form-group">
                    <label class="form-label">Player Name</label>
                    <input type="text" class="form-input" id="playerName" placeholder="Enter player name" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Skill Level (1-10)</label>
                    <input type="number" class="form-input" id="playerSkill" min="1" max="10" value="5" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Role</label>
                    <select class="form-select" id="playerRole" required>
                        <option value="batsman">Batsman</option>
                        <option value="bowler">Bowler</option>
                        <option value="allrounder">All-rounder</option>
                        <option value="wicketkeeper">Wicket Keeper</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Add Player</button>
                <button type="button" class="btn" onclick="const playerModal = document.getElementById('addPlayerModal'); if (playerModal) { playerModal.style.display = 'none'; }">Cancel</button>
            </form>
        </div>
    </div>

    <!-- Manual Team Adjustment Modal -->
    <div class="modal" id="manualAdjustModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">Manual Team Adjustment</div>
            <div class="manual-adjust-container">
                <div class="team-column">
                    <h4 id="team1NameAdjust">Team Lightning ‚ö°</h4>
                    <div class="player-list-adjust" id="team1PlayersAdjust">
                        <!-- Team 1 players will be loaded here -->
                    </div>
                </div>
                
                <div class="swap-controls">
                    <div class="swap-info">
                        Click any player (except captains) to move them to the other team
                    </div>
                </div>
                
                <div class="team-column">
                    <h4 id="team2NameAdjust">Team Thunder üå©Ô∏è</h4>
                    <div class="player-list-adjust" id="team2PlayersAdjust">
                        <!-- Team 2 players will be loaded here -->
                    </div>
                </div>
            </div>
            
            <div class="modal-actions">
                <button type="button" class="btn" onclick="const adjustModal = document.getElementById('manualAdjustModal'); if (adjustModal) { adjustModal.style.display = 'none'; }">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="console.log('Apply manual adjustments clicked'); alert('Manual adjustments feature will be implemented soon');">Apply Changes</button>
            </div>
        </div>
    </div>

    <script src="import-data.js?v=6&cb=1693749200"></script>
    <script src="data-manager.js?v=8&cb=1693750200"></script>
    <script src="app.js?v=30&cb=1725399600"></script>
    
    <script>
    // Immediately available debug functions - no waiting for app load
    window.checkDebugFunctions = function() {
        console.log('=== Debug Function Check ===');
        console.log('window.cricketApp exists:', !!window.cricketApp);
        console.log('window.app exists:', !!window.app);
        console.log('CricketApp class exists:', typeof CricketApp);
        console.log('debugBowlerSelection exists:', typeof window.debugBowlerSelection);
        
        if (window.cricketApp) {
            console.log('App state:');
            console.log('  - waitingForBowlerSelection:', window.cricketApp.waitingForBowlerSelection);
            console.log('  - currentMatch exists:', !!window.cricketApp.currentMatch);
            console.log('  - players count:', window.cricketApp.players?.length || 0);
            
            // Try to register debug functions if they don't exist
            if (typeof window.debugBowlerSelection !== 'function') {
                console.log('üìù Registering debug functions...');
                window.debugBowlerSelection = () => window.cricketApp.debugBowlerSelection();
                window.debugTestButton = () => window.cricketApp.debugTestButtonClick();
                window.debugForceReset = () => window.cricketApp.debugForceResetBowlerSelection();
                window.debugAppState = () => window.cricketApp.debugAppState();
                console.log('‚úÖ Debug functions registered!');
            }
        } else {
            console.log('‚ùå CricketApp not initialized yet');
            
            // Try to create app instance if class exists
            if (typeof CricketApp !== 'undefined') {
                console.log('üì± Creating CricketApp instance...');
                window.cricketApp = new CricketApp();
                window.app = window.cricketApp;
                
                // Register debug functions
                window.debugBowlerSelection = () => window.cricketApp.debugBowlerSelection();
                window.debugTestButton = () => window.cricketApp.debugTestButtonClick();
                window.debugForceReset = () => window.cricketApp.debugForceResetBowlerSelection();
                window.debugAppState = () => window.cricketApp.debugAppState();
                
                console.log('‚úÖ CricketApp created and debug functions registered!');
            } else {
                console.log('‚ùå CricketApp class not found');
            }
        }
        console.log('============================');
    };
    
    // Simple manual debug for bowler selection issue - works without app methods
    window.manualDebugBowlerSelection = function() {
        console.log('üîç === MANUAL BOWLER SELECTION DEBUG ===');
        
        const app = window.cricketApp || window.app;
        if (!app) {
            console.log('‚ùå No cricket app found');
            return;
        }
        
        console.log('1. App State:');
        console.log('  - waitingForBowlerSelection:', app.waitingForBowlerSelection);
        console.log('  - currentMatch exists:', !!app.currentMatch);
        
        console.log('2. Button Analysis:');
        const buttons = document.querySelectorAll('.score-btn');
        console.log('  - Total buttons:', buttons.length);
        console.log('  - Disabled buttons:', Array.from(buttons).filter(btn => btn.disabled).length);
        console.log('  - Buttons with opacity 0.5:', Array.from(buttons).filter(btn => btn.style.opacity === '0.5').length);
        
        if (buttons.length > 0) {
            const firstButton = buttons[0];
            console.log('  - First button state:', {
                disabled: firstButton.disabled,
                opacity: firstButton.style.opacity,
                pointerEvents: firstButton.style.pointerEvents,
                onclick: firstButton.onclick ? 'has onclick' : 'no onclick'
            });
        }
        
        console.log('3. Modal Check:');
        const modal = document.querySelector('.modal-overlay');
        console.log('  - Modal exists:', !!modal);
        
        console.log('4. Function Availability:');
        console.log('  - handleRunButton exists:', typeof window.handleRunButton);
        console.log('  - addRuns exists:', typeof window.addRuns);
        console.log('  - cricketApp.addRuns exists:', typeof app.addRuns);
        
        console.log('üîç === END MANUAL DEBUG ===');
        
        return {
            waitingForBowlerSelection: app.waitingForBowlerSelection,
            currentMatch: !!app.currentMatch,
            buttonCount: buttons.length,
            disabledButtons: Array.from(buttons).filter(btn => btn.disabled).length,
            modalExists: !!modal
        };
    };
    
    console.log('üí° Debug commands available:');
    console.log('  - checkDebugFunctions() - Check and setup debug system');
    console.log('  - manualDebugBowlerSelection() - Manual debug of bowler selection');
    </script>
    <script>
        // Enhanced Data Management Functions for BCCB Integration
        function exportData() {
            if (window.app && app.exportToCSV) {
                app.exportToCSV();
            } else {
                // Fallback: traditional JSON export
                const data = {
                    players: JSON.parse(localStorage.getItem('cricket-players') || '[]'),
                    teams: JSON.parse(localStorage.getItem('cricket-teams') || '[]'),
                    matches: JSON.parse(localStorage.getItem('cricket-matches') || '[]')
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'cricket-data-export.json';
                a.click();
                URL.revokeObjectURL(url);
                
                showNotification('üì± Data exported as JSON');
            }
        }
        
        function importData(event) {
            const files = event.target.files;
            if (!files || files.length === 0) return;
            
            // Check if we have CSV files (BCCB format)
            const csvFiles = Array.from(files).filter(file => file.name.endsWith('.csv'));
            if (csvFiles.length > 0 && window.app && app.importFromCSV) {
                // Use BCCB CSV import
                app.importFromCSV();
                return;
            }
            
            // Fallback: JSON import
            const file = files[0];
            if (file.type === 'application/json') {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = JSON.parse(e.target.result);
                        if (data.players && Array.isArray(data.players)) {
                            localStorage.setItem('cricket-players', JSON.stringify(data.players));
                        }
                        if (data.teams && Array.isArray(data.teams)) {
                            localStorage.setItem('cricket-teams', JSON.stringify(data.teams));
                        }
                        if (data.matches && Array.isArray(data.matches)) {
                            localStorage.setItem('cricket-matches', JSON.stringify(data.matches));
                        }
                        
                        location.reload(); // Reload to show imported data
                        showNotification('‚úÖ Data imported successfully');
                    } catch (error) {
                        console.error('Import error:', error);
                        showNotification('‚ùå Failed to import data');
                    }
                };
                reader.readAsText(file);
            }
        }
        
        function triggerImport() {
            document.getElementById('importFile').click();
        }
        
        function showNotification(message) {
            if (window.app && app.showNotification) {
                app.showNotification(message);
            } else {
                // Simple fallback notification
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: rgba(0, 0, 0, 0.8);
                    color: white;
                    padding: 12px 20px;
                    border-radius: 8px;
                    z-index: 10000;
                    font-size: 14px;
                `;
                notification.textContent = message;
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.remove();
                }, 3000);
            }
        }
        
        // Simple debug function available immediately
        window.checkDebugFunctions = function() {
            console.log('=== Debug Function Check ===');
            console.log('window.cricketApp exists:', !!window.cricketApp);
            console.log('debugBowlerSelection exists:', typeof window.debugBowlerSelection);
            console.log('debugTestButton exists:', typeof window.debugTestButton);
            console.log('debugForceReset exists:', typeof window.debugForceReset);
            console.log('debugAppState exists:', typeof window.debugAppState);
            
            if (window.cricketApp) {
                console.log('App state:');
                console.log('  - waitingForBowlerSelection:', window.cricketApp.waitingForBowlerSelection);
                console.log('  - currentMatch exists:', !!window.cricketApp.currentMatch);
                console.log('  - players count:', window.cricketApp.players.length);
            }
            console.log('============================');
        };
        
        console.log('üí° Use checkDebugFunctions() to verify debug system status');

        // Initialize app when page loads
        window.addEventListener('load', async () => {
            if (typeof CricketApp !== 'undefined') {
                console.log('üèè Initializing Cricket App...');
                
                // Wait a moment for data import to complete
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Don't override the existing cricketApp instance
                if (!window.cricketApp) {
                    window.cricketApp = new CricketApp();
                    
                    // Immediately register debug functions
                    window.debugBowlerSelection = () => window.cricketApp.debugBowlerSelection();
                    window.debugTestButton = () => window.cricketApp.debugTestButtonClick();
                    window.debugForceReset = () => window.cricketApp.debugForceResetBowlerSelection();
                    window.debugAppState = () => window.cricketApp.debugAppState();
                    
                    console.log('üîß Debug functions available immediately:');
                    console.log('  - debugBowlerSelection()');
                    console.log('  - debugTestButton()');
                    console.log('  - debugForceReset()');
                    console.log('  - debugAppState()');
                }
                // Keep backward compatibility
                window.app = window.cricketApp;
                console.log('‚úÖ Cricket App initialized with', window.cricketApp.players.length, 'players');
                
                // Add debug functions to window for easy access
                window.debugBowlerSelection = () => window.cricketApp.debugBowlerSelection();
                window.debugTestButton = () => window.cricketApp.debugTestButtonClick();
                window.debugForceReset = () => window.cricketApp.debugForceResetBowlerSelection();
                window.debugAppState = () => window.cricketApp.debugAppState();
                
                console.log('üîß Debug functions available:');
                console.log('  - debugBowlerSelection() - Comprehensive bowler selection debug');
                console.log('  - debugTestButton() - Test button click simulation');
                console.log('  - debugForceReset() - Force reset bowler selection state');
                console.log('  - debugAppState() - Basic app state check');
            }
        });

        // Global function for toggling player selection
        window.togglePlayerSelection = function(labelElement) {
            console.log('Player clicked:', labelElement);
            const checkbox = labelElement.querySelector('input[type="checkbox"]');
            const isSelected = labelElement.classList.contains('selected');
            
            console.log('Current state:', isSelected ? 'selected' : 'not selected');
            
            if (isSelected) {
                labelElement.classList.remove('selected');
                checkbox.checked = false;
            } else {
                labelElement.classList.add('selected');
                checkbox.checked = true;
            }
            
            updateSelectedPlayerCountInline();
        };

        // Global function to update player count
        window.updateSelectedPlayerCountInline = function() {
            const checkboxes = document.querySelectorAll('input[name="todayPlayers"]:checked');
            const count = checkboxes.length;
            const label = document.getElementById('selectedPlayerCount');
            if (label) {
                label.textContent = count.toString();
            }
        };

        // Settings tile toggle functionality
        function toggleTile(contentId, hintElement) {
            const content = document.getElementById(contentId);
            if (content.style.display === 'none') {
                content.style.display = 'block';
                hintElement.style.display = 'none';
            } else {
                content.style.display = 'none';
                hintElement.style.display = 'block';
            }
        }

        // Match settings save functionality
        function saveMatchSetting(settingName, value) {
            const settings = JSON.parse(localStorage.getItem('match-settings') || '{}');
            settings[settingName] = value;
            localStorage.setItem('match-settings', JSON.stringify(settings));
            
            if (window.cricketApp && window.cricketApp.showNotification) {
                if (settingName === 'totalOvers') {
                    window.cricketApp.showNotification(`üèè Match format updated to ${value} overs`);
                    
                    // Update the home page match format display
                    const matchFormatEl = document.getElementById('matchFormat');
                    if (matchFormatEl) {
                        matchFormatEl.textContent = value;
                    }
                    
                    // Update the display if no match is active
                    if (!window.cricketApp.currentMatch) {
                        window.cricketApp.updateScoreDisplay();
                    }
                } else {
                    window.cricketApp.showNotification(`‚úÖ ${settingName} updated to ${value}`);
                }
            }
            
            console.log('Match setting saved:', settingName, '=', value);
        }

        // Load saved match settings when page loads
        function loadMatchSettings() {
            const settings = JSON.parse(localStorage.getItem('match-settings') || '{}');
            
            // Set default values and load saved values
            const totalOversSelect = document.getElementById('totalOvers');
            const runsOnWideSelect = document.getElementById('runsOnWide');
            const runsOnNoBallSelect = document.getElementById('runsOnNoBall');
            const enableByesCheckbox = document.getElementById('enableByes');
            
            if (totalOversSelect) {
                const savedOvers = settings.totalOvers || 20;
                // Check if saved value matches predefined options
                const predefinedValues = ['5', '10', '15', '20', '25', '30', '40', '50'];
                if (predefinedValues.includes(savedOvers.toString())) {
                    totalOversSelect.value = savedOvers;
                } else {
                    // Custom value
                    totalOversSelect.value = 'custom';
                    const customInput = document.getElementById('customOvers');
                    if (customInput) {
                        customInput.style.display = 'block';
                        customInput.value = savedOvers;
                    }
                }
            }
            if (runsOnWideSelect) {
                runsOnWideSelect.value = settings.runsOnWide || '1';
            }
            if (runsOnNoBallSelect) {
                runsOnNoBallSelect.value = settings.runsOnNoBall || '1';
            }
            if (enableByesCheckbox) {
                enableByesCheckbox.checked = settings.enableByes || false;
            }
        }

        // Handle overs selection change
        function handleOversChange(value) {
            const customInput = document.getElementById('customOvers');
            
            if (value === 'custom') {
                customInput.style.display = 'block';
                customInput.focus();
            } else {
                customInput.style.display = 'none';
                saveMatchSetting('totalOvers', parseInt(value));
            }
        }

        // Set custom overs value
        function setCustomOvers(value) {
            const overs = parseInt(value);
            if (overs && overs >= 1 && overs <= 100) {
                saveMatchSetting('totalOvers', overs);
                if (window.cricketApp && window.cricketApp.showNotification) {
                    window.cricketApp.showNotification(`üèè Custom match format set to ${overs} overs`);
                }
                
                // Update the home page match format display
                const matchFormatEl = document.getElementById('matchFormat');
                if (matchFormatEl) {
                    matchFormatEl.textContent = overs;
                }
            } else {
                if (window.cricketApp && window.cricketApp.showNotification) {
                    window.cricketApp.showNotification(`‚ùå Please enter a valid number between 1 and 100`);
                }
                // Reset to default
                document.getElementById('totalOvers').value = '20';
                document.getElementById('customOvers').style.display = 'none';
            }
        }

        // Load settings when page is ready
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(loadMatchSettings, 100); // Small delay to ensure elements are ready
        });
    </script>

    <!-- DEBUG FUNCTIONS - LOADED AT END TO ENSURE EVERYTHING IS READY -->
    <script>
    // Force create debug functions immediately when page loads
    (function() {
        console.log('üîß Loading debug functions...');
        
        // Wait a moment for everything to load, then create debug functions
        setTimeout(function() {
            // Check if debug functions already exist
            if (typeof window.checkDebugFunctions === 'function') {
                console.log('‚úÖ Debug functions already exist');
                return;
            }
            
            console.log('üìù Creating debug functions...');
            
            // Immediate debug check function
            window.checkDebugFunctions = function() {
                console.log('=== Debug Function Check ===');
                console.log('window.cricketApp exists:', !!window.cricketApp);
                console.log('window.app exists:', !!window.app);
                console.log('CricketApp class exists:', typeof CricketApp);
                
                const app = window.cricketApp || window.app;
                if (app) {
                    console.log('‚úÖ App found! State:');
                    console.log('  - waitingForBowlerSelection:', app.waitingForBowlerSelection);
                    console.log('  - currentMatch exists:', !!app.currentMatch);
                    console.log('  - players count:', app.players?.length || 0);
                    
                    // Register main debug functions
                    if (app.debugBowlerSelection) {
                        window.debugBowlerSelection = () => app.debugBowlerSelection();
                        window.debugTestButton = () => app.debugTestButtonClick();
                        window.debugForceReset = () => app.debugForceResetBowlerSelection();
                        window.debugAppState = () => app.debugAppState();
                        console.log('‚úÖ Main debug functions registered!');
                    } else {
                        console.log('‚ö†Ô∏è App exists but debug methods not found');
                    }
                } else {
                    console.log('‚ùå No cricket app found');
                    
                    // Try to create one if class exists
                    if (typeof CricketApp !== 'undefined') {
                        console.log('üì± Creating CricketApp instance...');
                        try {
                            window.cricketApp = new CricketApp();
                            window.app = window.cricketApp;
                            console.log('‚úÖ CricketApp created successfully!');
                            
                            // Register debug functions
                            if (window.cricketApp.debugBowlerSelection) {
                                window.debugBowlerSelection = () => window.cricketApp.debugBowlerSelection();
                                window.debugTestButton = () => window.cricketApp.debugTestButtonClick();
                                window.debugForceReset = () => window.cricketApp.debugForceResetBowlerSelection();
                                window.debugAppState = () => window.cricketApp.debugAppState();
                                console.log('‚úÖ Debug functions registered after app creation!');
                            }
                        } catch (error) {
                            console.error('‚ùå Failed to create CricketApp:', error);
                        }
                    } else {
                        console.log('‚ùå CricketApp class not available');
                    }
                }
                console.log('============================');
            };
            
            // Simple manual debug function that works without app methods
            window.manualDebugBowlerSelection = function() {
                console.log('üîç === MANUAL BOWLER SELECTION DEBUG ===');
                
                const app = window.cricketApp || window.app;
                if (!app) {
                    console.log('‚ùå No cricket app found');
                    console.log('Available on window:', Object.keys(window).filter(k => k.includes('cricket')));
                    return { error: 'No app found' };
                }
                
                console.log('1. App State:');
                console.log('  - waitingForBowlerSelection:', app.waitingForBowlerSelection);
                console.log('  - currentMatch exists:', !!app.currentMatch);
                
                console.log('2. Button Analysis:');
                const buttons = document.querySelectorAll('.score-btn');
                const disabledButtons = Array.from(buttons).filter(btn => btn.disabled);
                const opacityButtons = Array.from(buttons).filter(btn => btn.style.opacity === '0.5');
                
                console.log('  - Total buttons:', buttons.length);
                console.log('  - Disabled buttons:', disabledButtons.length);
                console.log('  - Buttons with opacity 0.5:', opacityButtons.length);
                
                // Check specific button
                const testButton = document.querySelector('button[onclick="handleRunButton(1)"]');
                if (testButton) {
                    console.log('  - Test button (1 run) state:', {
                        disabled: testButton.disabled,
                        opacity: testButton.style.opacity,
                        pointerEvents: testButton.style.pointerEvents,
                        hasOnclick: !!testButton.onclick
                    });
                }
                
                console.log('3. Modal Check:');
                const modal = document.querySelector('.modal-overlay');
                console.log('  - Modal exists:', !!modal);
                
                console.log('4. Function Availability:');
                console.log('  - handleRunButton:', typeof window.handleRunButton);
                console.log('  - addRuns:', typeof window.addRuns);
                console.log('  - app.addRuns:', typeof app.addRuns);
                
                console.log('üîç === END MANUAL DEBUG ===');
                
                return {
                    waitingForBowlerSelection: app.waitingForBowlerSelection,
                    currentMatch: !!app.currentMatch,
                    buttonCount: buttons.length,
                    disabledButtons: disabledButtons.length,
                    opacityButtons: opacityButtons.length,
                    modalExists: !!modal,
                    testButtonDisabled: testButton ? testButton.disabled : 'not found'
                };
            };
            
            // Force reset function
            window.forceResetBowlerSelection = function() {
                console.log('üîß Force resetting bowler selection...');
                const app = window.cricketApp || window.app;
                if (!app) {
                    console.log('‚ùå No app found to reset');
                    return;
                }
                
                // Force clear the flag
                app.waitingForBowlerSelection = false;
                console.log('‚úÖ Set waitingForBowlerSelection to false');
                
                // Force enable all buttons
                const buttons = document.querySelectorAll('.score-btn');
                buttons.forEach(btn => {
                    btn.disabled = false;
                    btn.style.opacity = '1';
                    btn.style.pointerEvents = 'auto';
                });
                console.log('‚úÖ Enabled', buttons.length, 'buttons');
                
                // Remove any modals
                const modals = document.querySelectorAll('.modal-overlay');
                modals.forEach(modal => modal.remove());
                console.log('‚úÖ Removed', modals.length, 'modals');
                
                console.log('üîß Force reset complete!');
                return manualDebugBowlerSelection();
            };
            
            console.log('‚úÖ Debug functions created successfully!');
            console.log('üí° Available commands:');
            console.log('  - checkDebugFunctions()');
            console.log('  - manualDebugBowlerSelection()');
            console.log('  - forceResetBowlerSelection()');
            
        }, 500); // Wait 500ms for everything to load
        
    })();

    // Match History Functions
    function loadMatchHistory() {
        const historyContainer = document.getElementById('matchHistoryContainer');
        if (!historyContainer) return;

        console.log('üèè Loading match history...');

        // Load directly from cricket_stats.json since that's where the history is
        fetch('./cricket_stats.json')
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                console.log('üìä Loaded cricket stats data:', data);
                displayMatchHistory(data, historyContainer);
                
                // Also store in localStorage for future use
                localStorage.setItem('cricket-stats', JSON.stringify(data));
            })
            .catch(error => {
                console.error('‚ùå Error loading cricket_stats.json:', error);
                
                // Fallback: try to load from localStorage
                try {
                    const localData = JSON.parse(localStorage.getItem('cricket-stats'));
                    if (localData && (localData.matches || localData.history)) {
                        console.log('üì¶ Using localStorage fallback data');
                        displayMatchHistory(localData, historyContainer);
                    } else {
                        historyContainer.innerHTML = '<div class="no-matches">No match history available</div>';
                    }
                } catch (localError) {
                    console.error('‚ùå localStorage fallback failed:', localError);
                    historyContainer.innerHTML = '<div class="no-matches">Error loading match history</div>';
                }
            });
    }

    function displayMatchHistory(data, historyContainer) {
        console.log('üéØ Processing match history data:', data);
        
        // Handle both new format (matches) and legacy format (history)
        const matchesData = data.matches || data.history || [];
        
        if (!data || matchesData.length === 0) {
            historyContainer.innerHTML = '<div class="no-matches">No match history available</div>';
            console.log('‚ö†Ô∏è No match data found');
            return;
        }

        console.log(`üìã Found ${matchesData.length} matches in data`);

        // Sort matches by date (newest first)
        const sortedMatches = matchesData.sort((a, b) => {
            const dateA = new Date(a.Date || a.Date_Saved);
            const dateB = new Date(b.Date || b.Date_Saved);
            return dateB - dateA;
        });

        historyContainer.innerHTML = sortedMatches.map((match, index) => {
            console.log(`üîç Processing match ${index + 1}:`, match);
            
            // Handle both formats
            const matchDate = match.Date || match.Date_Saved;
            const date = new Date(matchDate);
            const formattedDate = date.toLocaleDateString('en-US', { 
                month: 'short', 
                day: 'numeric', 
                hour: '2-digit', 
                minute: '2-digit' 
            });

            // Handle new format vs legacy format
            let winningCaptain, losingCaptain, winningTeamScore, losingTeamScore, manOfMatch;
            let matchResult;
            
            if (match.Team1 && match.Team2) {
                // New format
                const team1 = match.Team1;
                const team2 = match.Team2;
                const team1Captain = getPlayerNameFromId(match.Team1_Captain, data.player_info);
                const team2Captain = getPlayerNameFromId(match.Team2_Captain, data.player_info);
                
                // Determine which captain won and which lost
                if (match.Winning_Team === team1) {
                    winningCaptain = team1Captain;
                    losingCaptain = team2Captain;
                } else {
                    winningCaptain = team2Captain;
                    losingCaptain = team1Captain;
                }
                
                winningTeamScore = match.Winning_Team_Score || 'N/A';
                losingTeamScore = match.Losing_Team_Score || 'N/A';
                matchResult = match.Result || `${match.Winning_Team} won`;
            } else {
                // Legacy format
                winningCaptain = match.Winning_Captain || 'Unknown';
                losingCaptain = match.Losing_Captain || 'Unknown';
                winningTeamScore = match.Winning_Team_Score || 'N/A';
                losingTeamScore = match.Losing_Team_Score || 'N/A';
                manOfMatch = match.Man_of_the_Match || 'Unknown';
                
                // Calculate margin for legacy format
                const winningScoreParts = (winningTeamScore || '0/0').split('/');
                const losingScoreParts = (losingTeamScore || '0/0').split('/');
                const winningScore = parseInt(winningScoreParts[0]) || 0;
                const losingScore = parseInt(losingScoreParts[0]) || 0;
                const margin = winningScore - losingScore;
                matchResult = `${winningCaptain}'s Team won by ${margin} runs`;
            }

            console.log(`‚úÖ Match processed: ${winningCaptain} vs ${losingCaptain}`);

            return `
                <div class="match-history-item" onclick="showMatchScorecard('${match.Match_ID}')">
                    <div class="match-summary">
                        <div class="match-teams">${winningCaptain} vs ${losingCaptain}</div>
                        <div class="match-date">${formattedDate}</div>
                    </div>
                    <div class="match-result">${matchResult}</div>
                    <div class="match-scores">${winningTeamScore} vs ${losingTeamScore}</div>
                </div>
            `;
        }).join('');

        console.log('‚úÖ Match history display completed');
    }

    // Helper function to get player name from Player_ID
    function getPlayerNameFromId(playerId, playerInfo) {
        if (!playerId || !playerInfo) return 'Unknown';
        
        // Handle both object format {P001: {name: "..."}} and array format [{Player_ID: "P001", Name: "..."}]
        if (Array.isArray(playerInfo)) {
            const player = playerInfo.find(p => p.Player_ID === playerId);
            return player ? (player.Name || player.name) : playerId;
        } else {
            // Object format
            const player = playerInfo[playerId];
            return player ? (player.Name || player.name) : playerId;
        }
    }

    function showMatchScorecard(matchId) {
        console.log('üèÜ Loading scorecard for match:', matchId);
        
        // Load data from cricket_stats.json (same as match history)
        fetch('./cricket_stats.json')
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                console.log('üìä Loaded data for scorecard:', data);
                displayScorecard(matchId, data);
            })
            .catch(error => {
                console.error('‚ùå Error loading scorecard data:', error);
                
                // Fallback: try localStorage
                try {
                    const localData = JSON.parse(localStorage.getItem('cricket-stats'));
                    if (localData) {
                        console.log('üì¶ Using localStorage for scorecard');
                        displayScorecard(matchId, localData);
                    } else {
                        throw new Error('No data available');
                    }
                } catch (localError) {
                    console.error('‚ùå Scorecard fallback failed:', localError);
                    if (window.cricketApp && window.cricketApp.showNotification) {
                        window.cricketApp.showNotification('‚ùå Error loading scorecard');
                    } else {
                        alert('Error loading scorecard');
                    }
                }
            });
    }

    function displayScorecard(matchId, data) {
        try {
            console.log('üéØ Finding match data for:', matchId);
            
            // Handle both new format (matches) and legacy format (history)
            const matchesData = data.matches || data.history || [];
            
            if (!data || matchesData.length === 0) {
                throw new Error('No match data available');
            }

            const match = matchesData.find(m => m.Match_ID === matchId);
            if (!match) {
                throw new Error(`Match ${matchId} not found in matches`);
            }

            console.log('‚úÖ Found match:', match);

            // Get detailed match data from batting, bowling sections
            const battingData = data.match_batting_performance ? data.match_batting_performance.filter(b => b.Match_ID === matchId) : [];
            const bowlingData = data.match_bowling_performance ? data.match_bowling_performance.filter(b => b.Match_ID === matchId) : [];

            console.log(`üìä Batting records: ${battingData.length}, Bowling records: ${bowlingData.length}`);

            // Handle date field - try both Date and Date_Saved
            const matchDate = match.Date || match.Date_Saved;
            const date = new Date(matchDate);
            
            // Handle scoring - different field names for new vs legacy format
            let winningScore, losingScore, margin;
            if (match.Winning_Team_Score && match.Losing_Team_Score) {
                winningScore = parseInt((match.Winning_Team_Score || '0/0').split('/')[0]) || 0;
                losingScore = parseInt((match.Losing_Team_Score || '0/0').split('/')[0]) || 0;
                margin = winningScore - losingScore;
            } else {
                winningScore = 0;
                losingScore = 0;
                margin = 0;
            }

            // Determine team and captain information based on format
            let team1Name, team2Name, team1Captain, team2Captain, winningTeam, losingTeam, matchResult;
            
            if (match.Team1 && match.Team2) {
                // New format
                team1Name = match.Team1;
                team2Name = match.Team2;
                team1Captain = getPlayerNameFromId(match.Team1_Captain, data.player_info) || match.Team1_Captain || 'Unknown';
                team2Captain = getPlayerNameFromId(match.Team2_Captain, data.player_info) || match.Team2_Captain || 'Unknown';
                winningTeam = match.Winning_Team;
                losingTeam = match.Losing_Team;
                matchResult = match.Result || `${winningTeam} won`;
            } else {
                // Legacy format
                team1Captain = match.Winning_Captain || 'Unknown';
                team2Captain = match.Losing_Captain || 'Unknown';
                team1Name = `${team1Captain}'s Team`;
                team2Name = `${team2Captain}'s Team`;
                winningTeam = team1Name;
                losingTeam = team2Name;
                matchResult = `${team1Captain}'s Team won by ${margin} runs`;
            }

            const modalHtml = `
                <div class="modal show" id="scorecardModal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <div class="modal-title">üìä Match Scorecard - ${matchId}</div>
                            <button class="close-btn" onclick="const modal = document.getElementById('scorecardModal'); if (modal) { modal.remove(); }">&times;</button>
                        </div>
                        
                        <div class="scorecard-section">
                            <div class="scorecard-header">üèÜ Match Summary</div>
                            <p><strong>Date:</strong> ${date.toLocaleString()}</p>
                            <p><strong>Teams:</strong> ${team1Name} vs ${team2Name}</p>
                            <p><strong>Captains:</strong> ${team1Captain} vs ${team2Captain}</p>
                            <p><strong>Result:</strong> ${matchResult}</p>
                            <p><strong>Final Scores:</strong> ${match.Winning_Team_Score || 'N/A'} vs ${match.Losing_Team_Score || 'N/A'}</p>
                            <p><strong>Overs Played:</strong> ${match.Winning_Team_Overs_Played || 'N/A'} vs ${match.Losing_Team_Overs_Played || 'N/A'}</p>
                            <p><strong>Man of the Match:</strong> ${match.Man_of_the_Match || 'Unknown'}</p>
                        </div>

                        <div class="scorecard-section">
                            <div class="scorecard-header">üèè Batting Performance</div>
                            ${battingData.length > 0 ? 
                                battingData.map(player => {
                                    const dismissalInfo = player.Out ? 
                                        (player.Dismissal_Details || `${player.Dismissal_Type || 'out'}`) : 
                                        'not out';
                                    return `
                                        <p><strong>${player.Player || 'Unknown'}:</strong> ${player.Runs || 0}${player.Out ? '' : '*'} (${player.Balls_Faced || 0} balls, ${player.Fours || 0} fours, ${player.Sixes || 0} sixes) - ${dismissalInfo}</p>
                                    `;
                                }).join('') 
                                : '<p>No batting data available</p>'
                            }
                        </div>

                        <div class="scorecard-section">
                            <div class="scorecard-header">‚öæ Bowling Performance</div>
                            ${bowlingData.length > 0 ? 
                                bowlingData.map(player => `
                                    <p><strong>${player.Player || 'Unknown'}:</strong> ${player.Overs || 0} overs, ${player.Runs || 0} runs, ${player.Wickets || 0} wickets (Econ: ${player.Economy || 'N/A'})</p>
                                `).join('')
                                : '<p>No bowling data available</p>'
                            }
                        </div>

                        <div class="match-actions">
                            <button class="btn btn-danger" onclick="if (confirm('Are you sure you want to delete this match?')) { alert('Delete match: ${matchId}'); const modal = document.getElementById('scorecardModal'); if (modal) { modal.remove(); } }">üóëÔ∏è Delete Match</button>
                            <button class="btn" onclick="const modal = document.getElementById('scorecardModal'); if (modal) { modal.remove(); }">Close</button>
                        </div>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', modalHtml);
            console.log('‚úÖ Scorecard modal displayed successfully');
            
        } catch (error) {
            console.error('‚ùå Error displaying scorecard:', error);
            if (window.cricketApp && window.cricketApp.showNotification) {
                window.cricketApp.showNotification('‚ùå Error loading scorecard: ' + error.message);
            } else {
                alert('Error loading scorecard: ' + error.message);
            }
        }
    }

    function closeScorecard() {
        const modal = document.getElementById('scorecardModal');
        if (modal) {
            modal.remove();
        }
    }

    function deleteMatch(matchId) {
        if (!confirm('Are you sure you want to delete this match? This action cannot be undone.')) {
            return;
        }

        console.log('üóëÔ∏è Deleting match:', matchId);

        // Load current data from JSON file
        fetch('./cricket_stats.json')
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                // Remove match from matches or history (handle both formats)
                if (data.matches) {
                    data.matches = data.matches.filter(m => m.Match_ID !== matchId);
                } else if (data.history) {
                    data.history = data.history.filter(m => m.Match_ID !== matchId);
                }
                
                // Remove associated batting and bowling data
                if (data.match_batting_performance) {
                    data.match_batting_performance = data.match_batting_performance.filter(b => b.Match_ID !== matchId);
                }
                if (data.match_bowling_performance) {
                    data.match_bowling_performance = data.match_bowling_performance.filter(b => b.Match_ID !== matchId);
                }
                if (data.index) {
                    data.index = data.index.filter(i => i.Match_ID !== matchId);
                }

                // Save updated data to localStorage
                localStorage.setItem('cricket-stats', JSON.stringify(data));
                
                console.log('‚úÖ Match deleted successfully');

                // Refresh the match history display
                loadMatchHistory();

                // Close the modal
                const modal = document.getElementById('scorecardModal');
                if (modal) {
                    modal.remove();
                }

                if (window.cricketApp && window.cricketApp.showNotification) {
                    window.cricketApp.showNotification('‚úÖ Match deleted successfully');
                } else {
                    alert('Match deleted successfully');
                }
            })
            .catch(error => {
                console.error('‚ùå Error deleting match:', error);
                if (window.cricketApp && window.cricketApp.showNotification) {
                    window.cricketApp.showNotification('‚ùå Error deleting match: ' + error.message);
                } else {
                    alert('Error deleting match: ' + error.message);
                }
            });
    }

    // Load match history when page loads
    // window.addEventListener('load', () => {
    //     // Load immediately
    //     loadMatchHistory();
    // });

    // // Also load when DOM is ready (even faster)
    // document.addEventListener('DOMContentLoaded', () => {
    //     setTimeout(() => {
    //         loadMatchHistory();
    //     }, 1000);
    // });

    // Make functions available globally for manual testing
    window.loadMatchHistory = loadMatchHistory;
    window.displayMatchHistory = displayMatchHistory;
    window.showMatchScorecard = showMatchScorecard;
    window.displayScorecard = displayScorecard;
    window.closeScorecard = closeScorecard;
    window.deleteMatch = deleteMatch;

    </script>
</body>
</html>
